---
import type { HeroProps } from "@types";
type Props = HeroProps;

const { name, specialty, summary, email } = Astro.props;
---

<section class="py-24 md:py-32" id="#hero">
  <h1
    class="mb-1.5 font-serif text-7xl font-bold tracking-tightest text-white sm:text-8xl md:mb-0 md:text-9xl"
  >
    {name}
  </h1>

  <p
    class="mb-9 font-serif text-4xl leading-[46px] font-bold tracking-tighter text-primary sm:text-5xl md:text-6xl"
  >
    {specialty}
  </p>

  <p class="mb-16 text-base font-normal text-neutral md:text-lg">
    {summary}
  </p>

  <!-- Get in Touch Button -->
  <a
    href={`mailto:${email}`}
    class="inline-block rounded-full bg-primary px-8 py-5 text-sm leading-5 font-medium text-white hover:bg-primary/80 transition mr-4"
  >
    Get in Touch
  </a>

  <!-- View Resume Button (opens modal) -->
  <button
    id="openResume"
    class="inline-flex items-center gap-2 rounded-full border border-primary px-8 py-5 text-sm leading-5 font-medium text-primary hover:bg-primary hover:text-white transition"
  >
    <span aria-hidden="true">üìÑ</span>
    <span>View Resume</span>
  </button>

  <!-- Modal Overlay -->
  <div
    id="resumeModal"
    class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity"
  >
    <!-- Modal Container -->
    <div
      id="resumeModalContent"
      class="bg-neutral-900 rounded-xl shadow-xl w-full max-w-4xl h-[85vh] relative transform scale-95 opacity-0 transition-all"
    >
      <!-- Header: Close + Download -->
      <div class="flex items-center justify-between px-4 pt-4 pb-2 border-b border-neutral-800">
        <p class="text-sm text-neutral-300">
          Resume ‚Äî <span class="font-medium text-white">Matthew Paz</span>
        </p>

        <div class="flex items-center gap-3">
          <!-- Download Resume button inside modal -->
          <a
            href="/MatthewPaz_Resume.pdf"
            download="MatthewPaz_Resume.pdf"
            class="inline-flex items-center gap-2 rounded-full border border-primary px-4 py-2 text-xs font-medium text-primary hover:bg-primary hover:text-white transition"
          >
            <span aria-hidden="true">‚¨áÔ∏è</span>
            <span>Download</span>
          </a>

          <!-- Close Button -->
          <button
            id="closeResume"
            class="text-white text-2xl leading-none hover:text-primary transition"
            aria-label="Close resume"
          >
            &times;
          </button>
        </div>
      </div>

      <!-- PDF Viewer -->
      <iframe
        src="/MatthewPaz_Resume.pdf"
        class="w-full h-[calc(100%-3rem)] rounded-b-xl"
      ></iframe>
    </div>
  </div>

  <!-- Modal Script -->
  <script>
    const openBtn = document.getElementById("openResume");
    const closeBtn = document.getElementById("closeResume");
    const modal = document.getElementById("resumeModal");
    const modalContent = document.getElementById("resumeModalContent");

    const openModal = () => {
      if (!modal || !modalContent) return;

      // Show overlay first
      modal.classList.remove("hidden");

      // Animate in on next frame
      requestAnimationFrame(() => {
        modal.classList.remove("opacity-0");
        modal.classList.add("opacity-100");

        modalContent.classList.remove("opacity-0", "scale-95");
        modalContent.classList.add("opacity-100", "scale-100");
      });
    };

    const closeModal = () => {
      if (!modal || !modalContent) return;

      modal.classList.remove("opacity-100");
      modal.classList.add("opacity-0");

      modalContent.classList.remove("opacity-100", "scale-100");
      modalContent.classList.add("opacity-0", "scale-95");

      // Wait for transition, then hide
      modal.addEventListener(
        "transitionend",
        () => {
          modal.classList.add("hidden");
        },
        { once: true }
      );
    };

    if (openBtn && closeBtn && modal && modalContent) {
      openBtn.addEventListener("click", openModal);
      closeBtn.addEventListener("click", closeModal);

      // Click outside content closes modal
      modal.addEventListener("click", (e) => {
        if (e.target === modal) {
          closeModal();
        }
      });

      // ESC key closes modal
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && !modal.classList.contains("hidden")) {
          closeModal();
        }
      });
    }
  </script>
</section>
